<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Test for jQuery validate() plugin</title>
    <link rel="stylesheet" type="text/css" media="screen" href="css/screen.css" />
    <script src="http://libs.baidu.com/jquery/1.8.3/jquery.js"></script>
    <script src="../jquery.validate.js" type="text/javascript"></script>
    <script src="../localization/messages_zh.js" type="text/javascript"></script>
    <script type="text/javascript">
    // extend the current rules with new groovy ones
    var currentLang = navigator.language;
    if (!currentLang) {
        console.log("in")
        currentLang = navigator.browserLanguage;
    }
    // 测试语言包
    console.log(currentLang)

    // 构建语言环境
    function vlang(lang) {
        var messages;
        switch (currentLang.toLowerCase()) {
            case "zh-cn":
                messages = {
                    buga: "请输入 buga!",
                    required: "必须填写",
                    minlength: "最小3个字啊"
                }
                break;
            default:
                messages = {
                    buga: "Please enter \'buga\'!",
                    required: "must in put",
                    minlength: "at least 3 word"
                }
        }
        return messages;
    }

    var myLang = $.extend({
        "lala": "lalala"
    }, vlang(currentLang));
    console.log(myLang)

    // this one requires the text "buga", we define a default message, too
    $.validator.addMethod("buga", function(value) {
        return value == "buga";
    }, myLang.buga);

    // this one requires the value to be the same as the first parameter
    $.validator.methods.equal = function(value, element, param) {
        // value 为定义的值，param 为输入的值
        return value == param;
    };

    $().ready(function() {
        var validator = $("#texttests").bind("invalid-form.validate", function() {
            $("#summary").html("Your form contains " + validator.numberOfInvalids() + " errors, see details below.");
        }).validate({
            debug: true,
            errorElement: "em", // 错误提示信息的容器 A
            errorContainer: $("#warning, #summary"), // 错误总数warning, summary
            errorPlacement: function(error, element) { // 位置
                error.appendTo(element.parent("td").next("td"));
            },
            success: function(label) { // 给A加上success类
                label.text("ok!").addClass("success");
            },
            rules: { // 对应input各ID的规则
                number: {
                    required: true,
                    minlength: 3,
                    maxlength: 15,
                    number: true
                },
                username: {
                    required: true,
                    minlength: 3
                },
                secret: "buga",
                math: {
                    equal: 11
                }
            },
            messages: {
                username: {
                    required: myLang.required,
                    minlength: myLang.minlength
                },
            }
        });
        $("#signupForm fieldset").prepend($("#test").html());
        // validate signup form on keyup and submit

        var myLv = $("#signupForm").validate({
            rules: {
                secret: "buga",
                firstname: "required",
                lastname: "required",
                username: {
                    required: true,
                    minlength: 2
                },
                password: {
                    required: true,
                    minlength: 5
                },
                confirm_password: {
                    required: true,
                    minlength: 5,
                    equalTo: "#password"
                },
                email: {
                    required: true,
                    email: true
                },
                topic: {
                    required: "#newsletter:checked",
                    minlength: 2
                },
                agree: "required"
            },
            messages: {
                firstname: "Please enter your firstname",
                lastname: "Please enter your lastname",
                username: {
                    // required: "Please enter a username",
                    minlength: "Your username must consist of at least 2 characters"
                },
                password: {
                    required: "Please provide a password",
                    minlength: "Your password must be at least 5 characters long"
                },
                confirm_password: {
                    required: "Please provide a password",
                    minlength: "Your password must be at least 5 characters long",
                    equalTo: "Please enter the same password as above"
                },
                email: "Please enter a valid email address",
                agree: "Please accept our policy"
            }
        });



    });
    </script>
    <style type="text/css">
    form.cmxform {
        width: 50em;
    }
    
    em.error {
        background: url("images/unchecked.gif") no-repeat 0px 0px;
        padding-left: 16px;
    }
    
    em.success {
        background: url("images/checked.gif") no-repeat 0px 0px;
        padding-left: 16px;
    }
    
    form.cmxform label.error {
        margin-left: auto;
        width: 250px;
    }
    
    em.error {
        color: black;
    }
    
    #warning {
        display: none;
    }
    </style>
</head>

<body>
    <h1 id="banner"><a href="http://bassistance.de/jquery-plugins/jquery-plugin-validation/">jQuery Validation Plugin</a> Demo</h1>
    <div id="main">
        <form class="cmxform" id="texttests" method="get" action="foo.html">
            <h2 id="summary"></h2>
            <fieldset>
                <legend>Example with custom methods and heavily customized error display</legend>
                <table>
                    <tr>
                        <td>
                            <label for="number">textarea</label>
                        </td>
                        <td>
                            <input id="number" name="number" title="Please enter a number with at least 3 and max 15 characters!" />
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <label for="secret">Secret</label>
                        </td>
                        <td>
                            <input name="secret" id="secret" />
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <label for="math">7 + 4 = </label>
                        </td>
                        <td>
                            <input id="math" name="math" title="Please enter the correct result!" />
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <label for="username">Usernames</label>
                        </td>
                        <td>
                            <input id="username" name="username" type="text" />
                        </td>
                        <td></td>
                    </tr>
                </table>
                <input class="submit" type="submit" value="Submit" />
            </fieldset>
        </form>
        <form class="cmxform" id="signupForm" method="get" action="">
            <fieldset>
                <legend>Validating a complete form</legend>
                <p>
                    <label for="secret">Secret</label>
                    <input name="secret" id="secret" />
                </p>
                <p>
                    <label for="firstname">Firstname</label>
                    <input id="firstname" name="firstname" type="text" />
                </p>
                <p>
                    <label for="lastname">Lastname</label>
                    <input id="lastname" name="lastname" type="text" />
                </p>
                <p>
                    <label for="username">Username</label>
                    <input id="username" name="username" type="text" />
                </p>
                <p>
                    <label for="agree">Please agree to our policy</label>
                    <input type="checkbox" class="checkbox" id="agree" name="agree" />
                </p>
                <p>
                    <label for="newsletter">I'd like to receive the newsletter</label>
                    <input type="checkbox" class="checkbox" id="newsletter" name="newsletter" />
                </p>
                <fieldset id="newsletter_topics">
                    <legend>Topics (select at least two) - note: would be hidden when newsletter isn't selected, but is visible here for the demo</legend>
                    <label for="topic_marketflash">
                        <input type="checkbox" id="topic_marketflash" value="marketflash" name="topic" /> Marketflash
                    </label>
                    <label for="topic_fuzz">
                        <input type="checkbox" id="topic_fuzz" value="fuzz" name="topic" /> Latest fuzz
                    </label>
                    <label for="topic_digester">
                        <input type="checkbox" id="topic_digester" value="digester" name="topic" /> Mailing list digester
                    </label>
                    <label for="topic" class="error">Please select at least two topics you'd like to receive.</label>
                </fieldset>
                <p>
                    <input class="submit" type="submit" value="Submit" />
                </p>
            </fieldset>
        </form>
        <div id="test" style="display:none;">
            <p>
                <label for="password">Password</label>
                <input id="password" name="password" type="password" />
            </p>
            <p>
                <label for="confirm_password">Confirm password</label>
                <input id="confirm_password" name="confirm_password" type="password" />
            </p>
            <p>
                <label for="email">Email</label>
                <input id="email" name="email" type="email" />
            </p>
        </div>
        <h3 id="warning">Your form contains tons of errors! Please try again.</h3>
        <p><a href="index.html">Back to main page</a></p>
    </div>
</body>

</html>
