(function(){$.extend({loadprogress:function(e){function u(){r.css({height:$(window).height()})}function c(){s.stop(!0,!1).animate({width:"100%"},400,"swing"),t.showText&&o.text("100%"),r.delay(200).fadeTo(t.duration,0,t.easing,function(){t.bodyOverflowFixTo&&(n.style.overflow=t.bodyOverflowFixTo),$(this).remove(),$(window).off("resize",u)})}function h(e){var n=t.manualMode?e/f*100-(100-t.manualModeStopNum):e/f*100;s.css({width:n+"%"}),t.showText&&o.text(Math.floor(n)+"%")}e=e||{};var t={imgSelector:"img",easing:"swing",duration:"1000",showText:!0,manualMode:!1,manualModeStopNum:95,bodyOverflowFixTo:!1};$.extend(t,e);var n=document.getElementsByTagName("body")[0];t.bodyOverflowFixTo&&(n.style.overflow="hidden");var r=$('<div id="loadprogress-overlay" />');r.css({height:$(window).height()});var i=$('<div id="loadprogress-box" />'),s=$('<div id="loadprogress-bar" />'),o="";t.showText&&(o=$('<div id="loadprogress-text" />'),o.text("0%")),$(window).resize(u).resize();var a=$(t.imgSelector),f=a.length,l=0;r.appendTo($("body")).append(i.append(s).append(o)),$(window).one("loadprogressEnd",function(){t.manualMode||c()}).bind("loadprogressProgress",function(e,t){h(t)}),t.manualMode&&$(window).one("loadprogressManualEnd",function(){c()}),a.each(function(){var e=$(this).attr("src");$("<img />").one("load error",function(){l+=1,f===l?$(window).trigger("loadprogressEnd"):$(window).trigger("loadprogressProgress",l)}).attr("src",e)})}})})(jQuery);